# modulesの中の設計の話

## 開発設計思想について

以下の思想に影響を受けながら適宜、個人的解釈や取捨選択を行っています。

- Container / Presentational Component Pattern
- Clean Architecture
- SOLID
- Atomic Design

## 原則・コンセプト

このリポジトリでは、主に以下を目指します。

1. できるだけ特定のフレームワークに依存しない
2. エンドユーザ、開発者、テスターなど、誰かにファーストなのではなく、どのレイヤーにとっても良いものを求め探る
3. HTMLを見れば今どのような状態かどうか、その箇所でどのような表示が作られるのか、判別できること
4. デザインコーディングだけでなく、TDD/DDDなどによるプロダクト的な開発に耐えられる程度に、CLeanな原則などを保持すること

それぞれ説明します。

### できるだけ特定のフレームワークに依存しない

フレームワークと書いていますが、念頭に置いているのは、ReactやVueといった開発用ライブラリ・フレームワークであり、バニラ開発主眼のリポジトリだよ、ということです。
利用を避ける理由は、以下につらつらと書き並べますが、要は「モダンなフレームワークとかそういう知識がなくても、基礎的な言語知識があれば、戦力になるリポジトリにしたい」っていう願望です。

#### 勉強難易度や用意できるリソース問題

世の中はReactやNextを普段から触っている・書ける人ばかりではありません。そしてチーム開発となるとお互いのバックグラウンドや経験値もさまざまです。
「Reactを勉強して貰えばいい」というのは個人に責任を負わせているのみですし、初学者が綺麗にプロダクト開発に入れるようになるには、相応のコストがかかるように感じます。
分かった気になって、クソコードで開発を進められたら、周囲や引き継ぐ人間も幸せになりません。
ビジネス上でフレームワークを利用する場合は、そういった人的リソースが狭まることを念頭におく必要があります。
筆者もフレームワークの恩恵は十分に感じていますが、あくまで、このリポジトリでは、依存せずバニラな言語達で開発を進められることを目指します、ということです。

#### 特定のフレームワークに頼るほど、対応柔軟性は犠牲になる

世の中にはスケールアップが不透明だったり、人の出入りの激しい現場があったりします。
ある一定のフレームワークに依存すると、どこかの時にプロダクトを継続できないリスクが生じますし、
「ReactはSPAを念頭にしているから、マルチページ開発に向かない」など、フレームワークやライブラリありきで制作すると、その分対応できないことは生まれます。
Web開発界隈は、「変化が激しい」みたいなことは常々話題になりますが、コアな要素はあくまで「HTML ,CSS,JS」だと思いますし、
ある程度の開発なら、バニラ開発も意外といけんじゃん？みたいなリポジトリに育つといいなぁと思っていたりします。

### エンドユーザ、開発者、テスターなど、誰かにファーストなのではなく、どのレイヤーにとっても良いものを求め探る

ちまたでよく話題に上がる、ユーザファースト、モバイルファースト、DX（Development Experience）、TDD（Test Driven Development）など、フロントエンド開発において、大切にすべき事柄は、多岐にわたります。
本来的には、それぞれの考え方はどれも大切なもので、優劣はありません。
しかし、現場の実態的には、クライアントの意向や、過去資産、要件などのビジネス面、関わる人間の空き時間やスキルセットなどの人的リソース面、などを事由として、断念や欠落、未対応などが起こります。時間は有限ですし、しょうがありません。
このテンプレートでは、「欠落しがち、忘れがちなものをあらかじめ設定して継ぎ足して更新していけば、常に開発人生がハッピーじゃん」という考え方が根底にあります。
楽に開発したいですし、ユーザにもいい体験を得てもらいたいし、テスターも不可が重いのは嫌だよね。
ということで、よろしくお付き合いください。

### HTMLを見れば今どのような状態かどうか、その箇所でどのような表示が作られるのか、判別できること

雑に説明すると「フロントエンドを作る ≒ ユーザがみる表示を作る のだから、セキュリティ的な勘案などないのであれば、ユーザが知るところが更新されているべきだよね」ということになります。

フロントエンド開発時に、状態管理というと、SPAやReduxなどの会話がされますが、このリポジトリではそういったものは考慮外です。
そうして「状態管理ってどうしよ」と考えた結果「ユーザがみるもの（HTML）を宣言的に構築するのだから、宣言されている事象が起きてないってのはおかしいし、宣言されてないものが、裏側でだけ起きているというのも変なことじゃない？」と思いました。
セキュリティ的に何でもかんでもDOMに配置するわけにもいかないですし、DOMをいちいち書き換えることで、負荷がありのも事実です。
しかし、データを読み込んでいるのに、画面が何も変わらない、なんてことはUXが悪いですし、大抵のことはユーザに知らせているはずです。

HTMLが最上位のエントリー兼状態管理の箱となるため、そこを見れば、いろいろなJSを回らなくても、ロジックにたどり着くことが、いいなぁと思います。

### デザインコーディングだけでなく、TDD/DDDなどによるプロダクト的な開発に耐えられる程度に、CLeanな原則などを保持すること

フロントエンドもバックエンドのデータから表示を作るだけでなく、ロジックやAPI通信、バリデーションなど、割と色々裏側で動いています。
全部サーバーサイドで完結するから、フロントは何もやらなくていい、ということはあまりみたことがありません。
そのため、テストやドメイン的な整理も、フロントエンド開発では必要不可欠です。
ガッチガチに決めるというよりは、ゆるく思想の影響を受けて、実装に使用するという程度で、ゆるくやっていきたいと思います。

## 階層区分

HTML
↓
Presentational Component(UI)

styleのみを責任とする。
対応するテストは、ビジュアルリグレッション、 Storybookなど。

- atoms
- molecules
- organism

↓
Container Component(Feature/State update/Interaction event)

各イベントや機能的なものをUIと切り離して管理することで、それぞれのソースの透明性を高めます。
style記述は持たず、あくまでUI仕様的な責任範囲です。

- JSONtoHTML
- Form handler / Validation updater
- Event handler

↓
Service(useCase/Application)

Container ComponentとInfrastructureの橋渡しと、各データ編集など機能面で必要な処理を行い、返却するのみで、ここで状態は持ちません。
もし記述量が少ないなどあれば、ContainerComponentにマージされるかもしれません。
対応するテストは単体テストです。

- validator / some checker
- After / Before data load Function
- data edit

↓
Infrastructure(To Backend or others env)

API通信や外部との連携に必要なソースがここに該当します。
localhostなどの時のモックアップは主にこの層を確認しながら、行います。

- fetch / XMRHttpRequest
- Promise / async , await

And...
Utility

Serviceに属さないけど、汎用的な関数や汎用styleがここに配置されます。
date pluginなどラッピングしてプロダクト各所で利用が想定される関数もここに置かれるのがいいと思います。
（個別のコンポーネントでの利用かグローバル利用かを判別したいので、TOPレイヤーにpluginフォルダは置かない、という判断もあります。）

- function
- styles

Model
プロジェクト全体に関わる変数・関数・型の定義を行います。

- core domain types
- core variables

assets

css,jsなどの記述ファイル以外のリソースが該当します。

- font
- images

### assets
